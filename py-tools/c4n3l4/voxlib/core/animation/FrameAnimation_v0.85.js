function vxlFrameAnimation(a){this.scene=null;this.timerID=0;this.actorByFrameMap=[];this.activeFrame=1;this.mark=1;this.running=false;this.frameCount=0;this.renderRate=500;this._setup(a);if(vxl.c.animation==null){vxl.c.animation=this}}vxlFrameAnimation.prototype.addActorToFrame=function(b,a){if(typeof(this.actorByFrameMap[b])=="undefined"){this.actorByFrameMap[b]=new Array()}if(this.actorByFrameMap[b].indexOf(a)==-1){this.actorByFrameMap[b].push(a)}if(b>this.frameCount){this.frameCount=b}};vxlFrameAnimation.prototype._setup=function(e){this.activeFrame=1;
for(var d in e){var b=e[d];var g=parseInt(d.substr(5,d.length));for(var c=0,a=b.length;c<a;c+=1){this.addActorToFrame(g,b[c])}}vxl.go.console("FrameAnimation: Setup finished.")};vxlFrameAnimation.prototype.start=function(){if(this.scene==null){throw"FrameAnimation: the animation is not associated with any scene. Please use scene.setFrameAnimation method"}this.running=true;this.timerID=setInterval((function(a){return function(){a.nextFrame()}})(this),this.renderRate)};vxlFrameAnimation.prototype.stop=function(){clearInterval(this.timerID);
this.running=false};vxlFrameAnimation.prototype.setFrameRate=function(a){if(a<=0){return}this.renderRate=a;this.stop();this.start()};vxlFrameAnimation.prototype.render=function(c){if(this.scene==null){throw"FrameAnimation: the animation is not associated with any scene. Please use scene.setFrameAnimation method"}if(!this.running){return}for(var a=0;a<this.actorByFrameMap[this.activeFrame].length;a++){var d=this.actorByFrameMap[this.activeFrame][a];var b=this.scene.getActorByName(d);if(b!=null){b.allocate(c);
b.render(c)}}};vxlFrameAnimation.prototype.isValidFrame=function(a){return(a>=1&&a<=this.frameCount)};vxlFrameAnimation.prototype.nextFrame=function(){if(this.activeFrame<this.frameCount){this.activeFrame++}else{this.activeFrame=1}};vxlFrameAnimation.prototype.getNextFrames=function(f){var d=[];var e=this.activeFrame;if(f>this.frameCount){f=this.frameCount}for(var a=1;a<=f;a++){var b=e+a;if(this.isValidFrame(b)){d.push(b)}else{d.push(b-this.frameCount)}}vxl.go.console("Animation: next frames: "+d);
return d};vxlFrameAnimation.prototype.getPreviousFrames=function(f){var d=[];var e=this.activeFrame;if(f>this.frameCount){f=this.frameCount}for(var a=1;a<=f;a++){var b=e-a;if(this.isValidFrame(b)){d.push(b)}else{d.push(this.frameCount+b)}}vxl.go.console("Animation: previous frames: "+d);return d};vxlFrameAnimation.prototype.setFrame=function(a){if(a>=1&&a<=this.frameCount){this.activeFrame=a;this.render()}};