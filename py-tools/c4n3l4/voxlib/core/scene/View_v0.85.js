function vxlView(b,a){this.name=b;this.canvas=document.getElementById(this.name);if(this.canvas==null){alert("The canvas "+b+" does not exist.");throw ("The canvas "+b+" does not exist.")}this.ready=false;this.width=this.canvas.width;this.height=this.canvas.height;this.clearDepth=10000;this.zNear=0.1;this.zFar=10000;this.fovy=10;this.backgroundColor=vxl.def.color.background.slice(0);this.ambientColor=vxl.def.color.ambient.slice(0);this.renderer=new vxlRenderer(this);this.setBackgroundColor(this.backgroundColor);
this.setClearDepth(this.clearDepth);this.cameraman=new vxlCameraManager(this);this.listener=new vxlViewListener(this);if(a!=null&&a instanceof vxlScene){this.scene=a}else{if(vxl.c.scene){this.scene=vxl.c.scene}else{this.scene=new vxlScene()}}this.scene.views.push(this);vxl.go.notifier.addTarget(vxl.events.SCENE_UPDATED,this);vxl.go.notifier.addTarget(vxl.events.DEFAULT_LUT_LOADED,this);this.ready=true;vxl.go.console("vxlView: the view "+this.name+" has been created")}vxlView.prototype.handleEvent=function(a,b){vxl.go.console("vxlView: receiving event "+a);
if(a==vxl.events.DEFAULT_LUT_LOADED){this.scene.setLookupTable(vxl.def.lut.main)}if(a==vxl.events.SCENE_UPDATED){this.cameraman.getActiveCamera().longShot()}};vxlView.prototype.clear=function(){this.renderer.clear()};vxlView.prototype.resize=function(){this.width=this.canvas.width;this.height=this.canvas.height};vxlView.prototype.prepareForRendering=function(){if(!this.ready){return}this.resize();this.clear()};vxlView.prototype.start=function(){this.renderer.start();this.refresh()};vxlView.prototype.stop=function(){this.renderer.stop()
};vxlView.prototype.reset=function(){this.stop();this.scene.reset();this.cameraman.reset();this.start()};vxlView.prototype.setBackgroundColor=function(a){this.backgroundColor=a.slice(0);this.renderer.clearColor(this.backgroundColor)};vxlView.prototype.setAmbientColor=function(a){this.ambientColor=a.slice(0);this.renderer.prg.setUniform("uAmbientColor",this.ambientColor)};vxlView.prototype.setClearDepth=function(a){this.renderer.clearDepth(a)};vxlView.prototype.refresh=function(){this.renderer.render()
};