vxlTrackballCameraInteractor.prototype=new vxlCameraInteractor();function vxlTrackballCameraInteractor(a){this.MOTION_FACTOR=10;this.task=vxl.def.camera.task.NONE;this.x=0;this.y=0;this.lastX=0;this.lastY=0;this.ctrlPressed=false;this.altPressed=false;this.keyPressed=0;this.button=-1;this.dragging=false;this.connectTo(a)}vxlTrackballCameraInteractor.prototype.onMouseUp=function(a){task=vxl.def.camera.task.NONE;this.dragging=false};vxlTrackballCameraInteractor.prototype.onMouseDown=function(a){this.x=a.clientX;
this.y=a.clientY;this.dragging=true;this.button=a.button};vxlTrackballCameraInteractor.prototype.onMouseMove=function(c){this.lastX=this.x;this.lastY=this.y;this.x=c.clientX;this.y=c.clientY;if(!this.dragging){return}this.ctrlPressed=c.ctrlKey;this.altPressed=c.altKey;var b=this.x-this.lastX;var a=this.y-this.lastY;if(this.button==0){if(this.ctrlPressed){this.dolly(a)}else{this.rotate(b,a)}}this.lastX=this.x;this.lastY=this.y};vxlTrackballCameraInteractor.prototype.onKeyDown=function(d){var c=this.camera;
this.keyPressed=d.keyCode;this.ctrlPressed=d.ctrlKey;if(!this.ctrlPressed){if(this.keyPressed==38){c.changeElevation(10);c.status("elevation up")}else{if(this.keyPressed==40){c.changeElevation(-10);c.status("elevation down")}else{if(this.keyPressed==37){c.changeAzimuth(-10);c.status("azimuth left")}else{if(this.keyPressed==39){c.changeAzimuth(10);c.status("azimuth right")}else{if(this.keyPressed=80){this.picking=!c.view.actorManager.picking;c.view.actorManager.setPicking(this.picking)}}}}}}else{if(this.ctrlPressed&&this.keyPressed!=17){var b=0;
var a=0;vxl.go.console(d);if(this.keyPressed==38){a=10}else{if(this.keyPressed==40){a=-10}else{if(this.keyPressed==37){b=-10}else{if(this.keyPressed==39){b=10}}}}if(b!=0||a!=0){this.pan(b,a)}}}};vxlTrackballCameraInteractor.prototype.onKeyUp=function(a){if(a.keyCode==17){this.ctrlPressed=false}};vxlTrackballCameraInteractor.prototype.dolly=function(c){this.task=vxl.def.camera.task.DOLLY;var b=this.camera;var a=2*this.MOTION_FACTOR*c/b.view.canvas.height;b.dolly(Math.pow(1.1,a));b.refresh()};vxlTrackballCameraInteractor.prototype.rotate=function(b,a){this.task=vxl.def.camera.task.ROTATE;
var e=this.camera;var c=e.view.canvas;var d=-20/c.height;var g=-20/c.width;var f=b*g*this.MOTION_FACTOR;var h=a*d*this.MOTION_FACTOR;e.changeAzimuth(f);e.changeElevation(h);e.refresh()};vxlTrackballCameraInteractor.prototype.pan=function(j,i){this.task=vxl.def.camera.task.PAN;var e=this.camera;var a=e.view.canvas;var d=e.view.scene;var h=Math.max(a.width,a.height);var c=1/h;var b=1/h;var g=j*c*this.MOTION_FACTOR*d.bb.max();var f=i*b*this.MOTION_FACTOR*d.bb.max();e.pan(g,f);e.refresh()};